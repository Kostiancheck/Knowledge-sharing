Overall idea: when you boot system, there is about a minute between seeing desktop wallpaper and logging into discord+valorant. I can use this time to learn about art.

Data sources:
- [Metropolitan Museum of Art](https://www.metmuseum.org/)
	- [metadata](https://github.com/metmuseum/openaccess)
	- [images](https://console.cloud.google.com/marketplace/details/the-metropolitan-museum-of-art/the-met-public-domain-art-works?inv=1&invt=Abmi7Q)
- [Viktoria and Albert Museum](https://www.vam.ac.uk/)
	- [API](https://developers.vam.ac.uk/)

Image manipulations:
- [Pillow (PIL)](https://pypi.org/project/pillow/)
- resize to fit screen; fill in background in spare space
- display metadata - orange rectangle
- display LLM description - black stripe

Metadata = from APIs/datasets
LLM description = generated by Claude

There are actually two scripts:
- one creates wallpaper
	- APIs, data, PIL
- one sets wallpaper
	- ctypes

Windows, Linux and MacOS kernels are all written in C. That's why Windows [Win32 API](https://learn.microsoft.com/en-us/windows/win32/desktop-programming) is easily accessible with C. Despite the name, the same API is used in 64 bit systems.

This API mixes some low-level syscalls (like [NtCancelWaitCompletionPacket](https://learn.microsoft.com/en-us/windows/win32/devnotes/ntcancelwaitcompletionpacket)) with higher level function calls (like [CreateWindowW](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-createwindoww)). To actually set a wallpaper we'll be using one of those higher-level functions - [SystemParametersInfoW](https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-systemparametersinfow).

Shared objects/libraries is a concept of compiling specific libraries meant to be shared by many application, thus improving efficiency and avoiding copying that code.
In Windows, they are called Dynamic-link libraries (.dll files).
In Linux, they are called Shared objects (.so files).

Each script has its own "deployment" quirks.

**Wallpaper generating script.**
The one that creates wallpaper is much more complicated. It requires data, API access, Claude token, dependencies etc. So we will bundle it with [pyinstaller](https://pyinstaller.org/en/stable/).

Pyinstaller quirks:
- output must fit in one file for easy "run on startup" configuration, hence '--onefile'
- by default, CMD console opens during script run, which we don't need, hence '--noconsole'
- we need to bundle MET metadata with script, as well as custom font, hence '--add-data'
- we need to pass Claude API token somehow, hence .env file and '--add-data'; later, .env file is read with 'python-dotenv'. NOTE that this .env will be sitting in pyinstallers' temp directory. It is NOT secure. 

**Wallpaper setting script.**
The other is much simpler (Python-wise). It's just pure Python that calls Windows API. 
However, to actually run it we need to wrap it in .cmd (.bat) script or .vbs script (or again .exe but why), as scheduler will just call `start C://whatever/the/path/to/file.exe`. It won't understand what `python` command is.
cmd/vbs quirks:
- there has to be global python installed, otherwise cmd won't know what `python` is; you can do multi-step with activating virtual env though
- cmd opens terminal by default which is distracting, so I wrapped it into .vbs
- used inline python inside vbs to pack everything to one file
To actually set an image as wallpaper we have to fire a signal to Windows API with ctyp

## Scheduling
Startup folder quirks:
- there are separate startup folders for user/system
- literally `start`s everything; so if you place .json file with some settings in the same folder to be accessed by script, it will `start` it too opening it in text editor
Task Scheduler
- stop after 3 days by default
- can only `start` too

Environment: there is pyenv for windows. Note that it's a tad different from linux variant.

Sources:
1. What languages are Windows, Mac OS X and Linux written in? https://stackoverflow.com/questions/580292/what-languages-are-windows-mac-os-x-and-linux-written-in
2. Dynamic-link library (DDL) https://en.wikipedia.org/wiki/Dynamic-link_library
3. Shared objects (SO) https://en.wikipedia.org/wiki/Shared_library
4. List of Windows syscalls https://j00ru.vexillium.org/syscalls/nt/64/
5. pyenv for windows https://github.com/pyenv-win/pyenv-win
6. github repo https://github.com/Demaga/art-wallpaper-changer